<!DOCTYPE html>
<html>
<head>
    <title>Simple Timeline Test</title>
    <style>
        body { padding: 40px; background: #f0f0f0; font-family: Arial; }
        
        .clip-visual-timeline {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            border: 1px solid #444;
            width: 600px;
        }

        .timeline-ruler {
            display: flex;
            justify-content: space-between;
            padding: 0 0 8px 0;
            border-bottom: 1px solid #555;
            margin-bottom: 10px;
        }

        .timeline-marker {
            font-size: 11px;
            color: #999;
            font-family: monospace;
        }

        .timeline-track {
            position: relative;
            height: 50px;
            background: #1a1a1a;
            border-radius: 6px;
        }

        .timeline-selection {
            position: absolute;
            top: 5px;
            height: 40px;
            background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
            border-radius: 4px;
            display: flex;
            align-items: center;
        }

        .timeline-selection-body {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 8px;
        }

        .timeline-time-label {
            color: white;
            font-size: 12px;
            font-weight: 600;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .timeline-handle {
            width: 12px;
            height: 100%;
            background: white;
            flex-shrink: 0;
        }

        .timeline-handle-left { border-radius: 4px 0 0 4px; }
        .timeline-handle-right { border-radius: 0 4px 4px 0; }
        
        .controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            width: 600px;
        }
        
        .controls label {
            display: block;
            margin: 10px 0 5px 0;
            font-weight: bold;
        }
        
        .controls input {
            width: 100px;
            padding: 5px;
        }
        
        .controls button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px 0 0;
        }
        
        .info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            width: 600px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>ðŸŽ¬ Simple Timeline Position Test</h1>
    
    <div class="controls">
        <label>Video Duration: <input type="number" id="videoDuration" value="240"> seconds</label>
        <label>Begin: <input type="number" id="begin" value="4" step="0.1"> seconds</label>
        <label>Duration: <input type="number" id="duration" value="3" step="0.1"> seconds</label>
        <button onclick="updateTimeline()">Update Timeline</button>
        <button onclick="test1()">Test: 4s-7s</button>
        <button onclick="test2()">Test: 60s-70s</button>
        <button onclick="test3()">Test: 120s-130s</button>
    </div>
    
    <div class="clip-visual-timeline">
        <div class="timeline-ruler" id="timelineRuler"></div>
        <div class="timeline-track" id="timelineTrack">
            <div class="timeline-selection" id="timelineSelection">
                <div class="timeline-handle timeline-handle-left"></div>
                <div class="timeline-selection-body">
                    <span class="timeline-time-label" id="timelineTimeLabel">0.0s - 5.0s</span>
                </div>
                <div class="timeline-handle timeline-handle-right"></div>
            </div>
        </div>
    </div>
    
    <div class="info" id="info">Click "Update Timeline" to see positioning...</div>

    <script>
        function buildRuler(videoDuration) {
            const ruler = document.getElementById('timelineRuler');
            ruler.innerHTML = '';
            
            let interval = videoDuration > 120 ? 15 : (videoDuration > 60 ? 10 : 5);
            const count = Math.ceil(videoDuration / interval) + 1;
            
            for (let i = 0; i < count; i++) {
                const time = i * interval;
                if (time > videoDuration) break;
                
                const marker = document.createElement('div');
                marker.className = 'timeline-marker';
                marker.textContent = `${time}s`;
                ruler.appendChild(marker);
            }
        }
        
        function updateTimeline() {
            const videoDuration = parseFloat(document.getElementById('videoDuration').value);
            const begin = parseFloat(document.getElementById('begin').value);
            const duration = parseFloat(document.getElementById('duration').value);
            
            buildRuler(videoDuration);
            
            const track = document.getElementById('timelineTrack');
            const selection = document.getElementById('timelineSelection');
            const label = document.getElementById('timelineTimeLabel');
            
            const trackWidth = track.clientWidth;
            
            // Calculate percentage
            const leftPercent = (begin / videoDuration) * 100;
            const widthPercent = (duration / videoDuration) * 100;
            
            // Apply
            selection.style.left = `${leftPercent}%`;
            selection.style.width = `${widthPercent}%`;
            
            // Update label
            label.textContent = `${begin.toFixed(1)}s - ${(begin + duration).toFixed(1)}s`;
            
            // Show info
            document.getElementById('info').innerHTML = `
                <strong>Calculation:</strong><br>
                Video Duration: ${videoDuration}s<br>
                Begin: ${begin}s<br>
                Duration: ${duration}s<br>
                Track Width: ${trackWidth}px<br>
                Left: ${leftPercent.toFixed(2)}%<br>
                Width: ${widthPercent.toFixed(2)}%<br>
                <br>
                <strong>Applied Styles:</strong><br>
                selection.style.left = "${selection.style.left}"<br>
                selection.style.width = "${selection.style.width}"<br>
                <br>
                <strong>Computed:</strong><br>
                offsetLeft: ${selection.offsetLeft}px<br>
                offsetWidth: ${selection.offsetWidth}px
            `;
        }
        
        function test1() {
            document.getElementById('begin').value = 4;
            document.getElementById('duration').value = 3;
            updateTimeline();
        }
        
        function test2() {
            document.getElementById('begin').value = 60;
            document.getElementById('duration').value = 10;
            updateTimeline();
        }
        
        function test3() {
            document.getElementById('begin').value = 120;
            document.getElementById('duration').value = 10;
            updateTimeline();
        }
        
        // Auto-run on load
        window.addEventListener('load', () => {
            setTimeout(updateTimeline, 100);
        });
    </script>
</body>
</html>
